<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation â€” AgentJobs</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <nav>
        <a href="/" class="nav-logo">âš¡ Agent<span>Jobs</span></a>
        <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="/search">Search</a></li>
            <li><a href="/docs-page" class="active">API Docs</a></li>
            <li><a href="/agent">Hire an Agent</a></li>
        </ul>
    </nav>

    <section class="section" style="max-width:900px;">
        <h1 style="font-size:36px;margin-bottom:8px;">ðŸ“– API Documentation</h1>
        <p style="color:var(--text-secondary);margin-bottom:8px;">Base URL: <code style="color:var(--accent);font-family:'JetBrains Mono',monospace;">http://localhost:8000</code></p>
        <p style="color:var(--text-secondary);margin-bottom:32px;">Interactive docs also available at <a href="/docs">/docs</a> (Swagger UI) and <a href="/redoc">/redoc</a> (ReDoc)</p>

        <!-- Jobs Search -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/jobs</span>
            </div>
            <p class="endpoint-desc">Search and filter job listings. Optimized for AI agent consumption with structured JSON responses.</p>
            
            <table class="params-table">
                <thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>q</code></td><td>string</td><td>Full-text search query</td></tr>
                    <tr><td><code>title</code></td><td>string</td><td>Filter by job title</td></tr>
                    <tr><td><code>location</code></td><td>string</td><td>Filter by city/state</td></tr>
                    <tr><td><code>location_type</code></td><td>string</td><td>onsite, remote, or hybrid</td></tr>
                    <tr><td><code>company</code></td><td>string</td><td>Filter by company name</td></tr>
                    <tr><td><code>skills</code></td><td>string</td><td>Comma-separated skills filter</td></tr>
                    <tr><td><code>salary_min</code></td><td>integer</td><td>Minimum monthly salary (INR)</td></tr>
                    <tr><td><code>salary_max</code></td><td>integer</td><td>Maximum monthly salary (INR)</td></tr>
                    <tr><td><code>experience_min</code></td><td>integer</td><td>Minimum years of experience</td></tr>
                    <tr><td><code>experience_max</code></td><td>integer</td><td>Maximum years of experience</td></tr>
                    <tr><td><code>category</code></td><td>string</td><td>Job category (engineering, data-science, etc.)</td></tr>
                    <tr><td><code>employment_type</code></td><td>string</td><td>full-time, part-time, contract, internship</td></tr>
                    <tr><td><code>posted_after</code></td><td>string</td><td>ISO date (YYYY-MM-DD)</td></tr>
                    <tr><td><code>sort</code></td><td>string</td><td>relevance, posted_at, or salary</td></tr>
                    <tr><td><code>limit</code></td><td>integer</td><td>Results per page (1-100, default 20)</td></tr>
                    <tr><td><code>offset</code></td><td>integer</td><td>Pagination offset</td></tr>
                </tbody>
            </table>

            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl "http://localhost:8000/api/v1/jobs?q=python+developer&location=Bangalore&salary_min=80000&limit=5"</pre>
            </div>
            <div class="code-block">
                <span class="lang-label">python</span>
                <pre>import requests

resp = requests.get("http://localhost:8000/api/v1/jobs", params={
    "q": "python developer",
    "location": "Bangalore",
    "salary_min": 80000,
    "limit": 5,
})
data = resp.json()
print(f"Found {data['total']} jobs in {data['query_time_ms']}ms")</pre>
            </div>
            <div class="code-block">
                <span class="lang-label">javascript</span>
                <pre>const resp = await fetch('/api/v1/jobs?q=python+developer&location=Bangalore&limit=5');
const data = await resp.json();
console.log(`Found ${data.total} jobs in ${data.query_time_ms}ms`);</pre>
            </div>
        </div>

        <!-- Get Job -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/jobs/{job_id}</span>
            </div>
            <p class="endpoint-desc">Get full details for a specific job listing including complete description.</p>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl "http://localhost:8000/api/v1/jobs/j_abc123"</pre>
            </div>
        </div>

        <!-- Agent Search -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-post">POST</span>
                <span class="endpoint-path">/api/v1/agent/search</span>
            </div>
            <p class="endpoint-desc">AI-powered job matching. Submit a resume or structured profile and get scored matches with detailed reasons. Response in &lt;3 seconds.</p>
            
            <table class="params-table">
                <thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>resume_text</code></td><td>string</td><td>Full resume text or summary</td></tr>
                    <tr><td><code>skills</code></td><td>string[]</td><td>List of candidate skills</td></tr>
                    <tr><td><code>experience_years</code></td><td>integer</td><td>Years of experience</td></tr>
                    <tr><td><code>preferred_locations</code></td><td>string[]</td><td>Preferred work locations</td></tr>
                    <tr><td><code>salary_min</code></td><td>integer</td><td>Minimum monthly salary (INR)</td></tr>
                    <tr><td><code>job_preferences</code></td><td>string</td><td>Free-text preferences</td></tr>
                    <tr><td><code>limit</code></td><td>integer</td><td>Max results (default 20)</td></tr>
                </tbody>
            </table>

            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl -X POST "http://localhost:8000/api/v1/agent/search" \
  -H "Content-Type: application/json" \
  -d '{
    "skills": ["python", "sql", "machine-learning"],
    "experience_years": 3,
    "preferred_locations": ["Hyderabad", "Bangalore"],
    "salary_min": 80000,
    "limit": 10
  }'</pre>
            </div>
            <div class="code-block">
                <span class="lang-label">python</span>
                <pre>resp = requests.post("http://localhost:8000/api/v1/agent/search", json={
    "resume_text": "3 years experience in Python, SQL, ML. Worked at ...",
    "preferred_locations": ["Hyderabad"],
    "salary_min": 80000,
})
matches = resp.json()
for job in matches["jobs"][:5]:
    print(f"  {job['match_score']}% â€” {job['title']} @ {job['company']}")</pre>
            </div>
        </div>

        <!-- Companies -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/companies</span>
            </div>
            <p class="endpoint-desc">List companies with filters for industry, size, and location.</p>
            <table class="params-table">
                <thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>industry</code></td><td>string</td><td>Industry filter</td></tr>
                    <tr><td><code>size</code></td><td>string</td><td>startup, small, medium, large, enterprise</td></tr>
                    <tr><td><code>location</code></td><td>string</td><td>Location filter</td></tr>
                    <tr><td><code>q</code></td><td>string</td><td>Search by name</td></tr>
                </tbody>
            </table>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl "http://localhost:8000/api/v1/companies?industry=Fintech&size=medium"</pre>
            </div>
        </div>

        <!-- Company Detail -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/companies/{company_id}</span>
            </div>
            <p class="endpoint-desc">Get company details with active job count.</p>
        </div>

        <!-- Stats -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/stats</span>
            </div>
            <p class="endpoint-desc">Platform statistics: total jobs, companies, category breakdown, location breakdown.</p>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl "http://localhost:8000/api/v1/stats"</pre>
            </div>
        </div>

        <!-- Categories -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/categories</span>
            </div>
            <p class="endpoint-desc">List all job categories with job counts.</p>
        </div>

        <!-- Trending Skills -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/skills/trending</span>
            </div>
            <p class="endpoint-desc">Top 30 in-demand skills based on active job listings.</p>
        </div>

        <!-- Auth -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-post">POST</span>
                <span class="endpoint-path">/api/v1/auth/register</span>
            </div>
            <p class="endpoint-desc">Register for an API key. Currently all endpoints work without auth for easy testing.</p>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"email": "you@example.com", "name": "Your Name"}'</pre>
            </div>
        </div>

        <!-- Usage -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/auth/usage</span>
            </div>
            <p class="endpoint-desc">Check your API key usage stats. Requires X-API-Key header.</p>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl -H "X-API-Key: aj_your_key_here" "http://localhost:8000/api/v1/auth/usage"</pre>
            </div>
        </div>

        <!-- MCP -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/mcp/manifest.json</span>
            </div>
            <p class="endpoint-desc">MCP tool manifest for AI agent discovery. Exposes search_jobs, match_resume, get_job_details, and list_companies tools.</p>
            <div class="code-block">
                <span class="lang-label">curl</span>
                <pre>curl "http://localhost:8000/mcp/manifest.json" | python -m json.tool</pre>
            </div>
        </div>

        <!-- Health -->
        <div class="endpoint">
            <div>
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/health</span>
            </div>
            <p class="endpoint-desc">Health check endpoint.</p>
        </div>
    </section>

    <footer>
        <p>AgentJobs v1.0 Â· <a href="/docs">Swagger UI</a> Â· <a href="/redoc">ReDoc</a></p>
    </footer>
</body>
</html>
